import{C as k,q as e,r as c,M as Z,B as l,T as o,D as O,E as ee,z as f,L as se,G as te,H as ae,J as ne,u as z,K as y,o as re,p as le,x as F,F as S,I as E,S as P,P as ie,y as ce}from"./index-B9B21zUj.js";import{h as H,H as L,T as oe,E as de,a as xe,C as ue,M as i,b as he,c as je,d as N,e as d,f as pe,g as me,i as ye}from"./HourglassEmpty-Ceaz0ryg.js";const R=k(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),fe=k(e.jsx("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),ge=a=>{const x=a.split(".");return x.length>1?x[x.length-1]:""},be=a=>{switch(ge(a.file_name).toLowerCase()){case"jpg":case"jpeg":case"png":case"bmp":return e.jsx(y,{src:a.file_presentation,alt:a.file_name,variant:"square"});case"pdf":return e.jsx(y,{src:"/test-app/assets/icons/pdf.png",alt:a.file_name,variant:"square"});case"doc":case"docx":return e.jsx(y,{src:"/test-app/assets/icons/doc.png",alt:a.file_name,variant:"square"});case"xls":case"xlsx":return e.jsx(y,{src:"/test-app/assets/icons/xls.png",alt:a.file_name,variant:"square"});case"rtf":return e.jsx(y,{src:"/test-app/assets/icons/rtf.png",alt:a.file_name,variant:"square"});default:return e.jsx(y,{variant:"square",children:a.file_name[0]})}},ve=a=>{const x=a.file_presentation,t=document.createElement("a");t.href=x,t.download=a.file_name,document.body.appendChild(t),t.click(),document.body.removeChild(t)},_e=({open:a,onClose:x,selectedRow:t})=>{const[g,j]=c.useState([]);c.useEffect(()=>{t&&j(t.files)},[t]);const m=()=>{j([]),x()},p=u=>{switch(u){case"IN_PROCESS":return e.jsx(L,{color:"warning"});case"FINISHED":return e.jsx(H,{color:"success"});case"REJECTED":return e.jsx(R,{color:"error"});default:return null}},b=u=>u==="IN"?"Входящий":"Исходящий";return e.jsx(Z,{open:a,onClose:m,children:e.jsxs(l,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"h5",component:"h2",children:"Заявка"}),e.jsx(O,{size:"medium",onClick:m,children:e.jsx(ee,{})})]}),t&&e.jsxs(l,{sx:{display:"flex",flexDirection:"column",mb:2},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(o,{variant:"body2",children:["Дата документа: ",f(new Date(t.document_date),"dd.MM.yyyy")]}),e.jsxs(o,{variant:"body2",children:["Номер документа: ",t.document_number]})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(o,{variant:"body2",children:["Тип документа: ",b(t.document_type)]}),e.jsxs(o,{variant:"body2",children:["Дата записи: ",f(new Date(t.record_date),"dd.MM.yyyy")]})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(o,{variant:"body2",children:["Статус записи: ",p(t.record_status)]}),e.jsxs(o,{variant:"body2",children:["Комментарий к статусу: ",t.record_status_comment]})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(o,{variant:"body2",children:["Комментарий к записи: ",t.record_comment]}),e.jsxs(o,{variant:"body2",children:["Организация: ",t.organization_name]})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(o,{variant:"body2",children:["Налоговый период: ",t.tax_period]}),e.jsxs(o,{variant:"body2",children:["Конец налогового периода: ",f(new Date(t.tax_period_end_date),"dd.MM.yyyy")]})]})]}),e.jsx(se,{children:g.map((u,v)=>e.jsxs(te,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(ae,{children:be(u)}),e.jsx(ne,{primary:u.file_name}),e.jsx(O,{edge:"end","aria-label":"download",onClick:()=>ve(u),children:e.jsx(fe,{})})]},v))}),e.jsx(l,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:e.jsx(z,{variant:"outlined",onClick:m,children:"Закрыть"})})]})})},Ce=re(oe)({backgroundColor:"#f0f0f0"}),Ee=()=>{const[a,x]=c.useState("asc"),[t,g]=c.useState("document_date"),[j,m]=c.useState(0),[p,b]=c.useState(30),[u,v]=c.useState([]),[q,T]=c.useState([]),[D,A]=c.useState(null),[_,B]=c.useState(!1),[r,C]=c.useState({documentType:"",organizationName:"",taxPeriod:"",recordStatus:""}),[$,w]=c.useState(!1);c.useEffect(()=>{J()},[j,p,r]);const J=async()=>{try{const s=await le.get("/test-app/assets/data/archive-data.json");v(s.data),T(s.data)}catch(s){console.error("Ошибка при загрузке данных:",s)}},Q=s=>{x(t===s&&a==="asc"?"desc":"asc"),g(s)},W=(s,n)=>{m(n)},V=s=>{b(parseInt(s.target.value,10)),m(0)},G=s=>{A(s),w(!0)},K=()=>{B(!_)},I=s=>{const{name:n,value:h}=s.target;C(X=>({...X,[n]:h}))};c.useEffect(()=>{(()=>{let n=u;r.documentType&&(n=n.filter(h=>h.document_type===r.documentType)),r.organizationName&&(n=n.filter(h=>h.organization_name.includes(r.organizationName))),r.taxPeriod&&(n=n.filter(h=>h.tax_period===r.taxPeriod)),r.recordStatus&&(n=n.filter(h=>h.record_status===r.recordStatus)),T(n)})()},[r,u]);const M=q.sort((s,n)=>t==="document_date"?a==="asc"?new Date(s.document_date).getTime()-new Date(n.document_date).getTime():new Date(n.document_date).getTime()-new Date(s.document_date).getTime():0),U=()=>{w(!1)},Y=s=>{switch(s){case"IN_PROCESS":return e.jsx(L,{color:"action"});case"FINISHED":return e.jsx(H,{color:"success"});case"REJECTED":return e.jsx(R,{color:"error"});default:return null}};return e.jsxs(l,{margin:2,children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsx(o,{variant:"h4",component:"h4",children:"Архив"})}),e.jsx(l,{sx:{display:"flex",alignItems:"center",p:2},children:e.jsx(z,{onClick:K,endIcon:_?e.jsx(de,{}):e.jsx(xe,{}),children:"Фильтр"})}),e.jsx(ue,{in:_,children:e.jsxs(l,{sx:{p:2},children:[e.jsxs(l,{children:[e.jsx(o,{component:"h6",children:"Период"}),e.jsx(F,{label:"С",type:"date",value:r.documentType,onChange:s=>C({...r,documentType:s.target.value}),InputLabelProps:{shrink:!0},sx:{mr:2}}),e.jsx(F,{label:"До",type:"date",value:r.organizationName,onChange:s=>C({...r,organizationName:s.target.value}),InputLabelProps:{shrink:!0}})]}),e.jsx(l,{sx:{mt:2},children:e.jsxs(S,{fullWidth:!0,children:[e.jsx(E,{id:"document-type-filter-label",children:"Тип документа"}),e.jsxs(P,{labelId:"document-type-filter-label",name:"documentType",value:r.documentType,onChange:I,label:"Тип документа",children:[e.jsx(i,{value:"",children:e.jsx("em",{children:"Все"})}),e.jsx(i,{value:"IN",children:"Входящий"}),e.jsx(i,{value:"OUT",children:"Исходящий"})]})]})}),e.jsx(l,{sx:{mt:2},children:e.jsxs(S,{fullWidth:!0,children:[e.jsx(E,{id:"tax-period-filter-label",children:"Налоговый период"}),e.jsxs(P,{labelId:"tax-period-filter-label",name:"taxPeriod",value:r.taxPeriod,onChange:I,label:"Налоговый период",children:[e.jsx(i,{value:"",children:e.jsx("em",{children:"Все"})}),e.jsx(i,{value:"PERIOD_MONTH",children:"Месяц"}),e.jsx(i,{value:"PERIOD_Q1",children:"1 квартал"}),e.jsx(i,{value:"PERIOD_Q2",children:"2 квартал"}),e.jsx(i,{value:"PERIOD_Q3",children:"3 квартал"}),e.jsx(i,{value:"PERIOD_Q4",children:"4 квартал"}),e.jsx(i,{value:"PERIOD_YEAR",children:"Год"})]})]})}),e.jsx(l,{sx:{mt:2},children:e.jsxs(S,{fullWidth:!0,children:[e.jsx(E,{id:"status-filter-label",children:"Статус"}),e.jsxs(P,{labelId:"status-filter-label",name:"recordStatus",value:r.recordStatus,onChange:I,label:"Статус",children:[e.jsx(i,{value:"",children:e.jsx("em",{children:"Все"})}),e.jsx(i,{value:"IN_PROCESS",children:"В обработке"}),e.jsx(i,{value:"FINISHED",children:"Завершена"}),e.jsx(i,{value:"REJECTED",children:"Отвергнута"})]})]})})]})}),e.jsxs(ie,{children:[e.jsx(he,{children:e.jsxs(je,{children:[e.jsx(Ce,{children:e.jsxs(N,{children:[e.jsx(d,{children:e.jsx(pe,{active:t==="document_date",direction:t==="document_date"?a:"asc",onClick:()=>Q("document_date"),children:"Дата"})}),e.jsx(d,{children:"Номер исходного документа"}),e.jsx(d,{children:"Тип исходного документа"}),e.jsx(d,{children:"Имя организации"}),e.jsx(d,{children:"Налоговый период"}),e.jsx(d,{children:"Статус заявки"})]})}),e.jsx(me,{children:M.slice(j*p,j*p+p).map((s,n)=>e.jsxs(N,{onClick:()=>G(s),style:{cursor:"pointer"},children:[e.jsx(d,{children:ce(new Date(s.document_date))?f(new Date(s.document_date),"dd.MM.yyyy"):"Invalid date"}),e.jsx(d,{children:s.document_number}),e.jsx(d,{children:s.document_type==="IN"?"Входящий":"Исходящий"}),e.jsx(d,{children:s.organization_name}),e.jsx(d,{children:s.tax_period}),e.jsx(d,{children:Y(s.record_status)})]},n))})]})}),e.jsx(ye,{rowsPerPageOptions:[10,30,50],component:"div",count:M.length,rowsPerPage:p,page:j,onPageChange:W,onRowsPerPageChange:V})]}),D&&e.jsx(_e,{open:$,onClose:U,selectedRow:D})]})};export{Ee as default};
